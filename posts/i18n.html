<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/valaxy-theme-hardlight/favicon.svg"><script>const prefersDark=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,colorSchemeSetting=localStorage.getItem("vueuse-color-scheme")||"auto";("dark"===colorSchemeSetting||prefersDark&&"light"!==colorSchemeSetting)&&document.documentElement.classList.toggle("dark",!0)</script><script>const locale=localStorage.getItem("valaxy-locale")||"zh-CN";document.documentElement.setAttribute("lang",locale)</script><script type="module" async="" crossorigin="" src="/valaxy-theme-hardlight/assets/app-7b6c754a.js"></script><link rel="stylesheet" href="/valaxy-theme-hardlight/assets/index-f09ce544.css"><link rel="modulepreload" crossorigin="" href="/valaxy-theme-hardlight/assets/post-01a4b063.js"><link rel="modulepreload" crossorigin="" href="/valaxy-theme-hardlight/assets/i18n-30894f32.js"><title>i18n - Valaxy Theme Hardlight</title><link rel="icon" href="/favicon.svg" type="image/svg+xml"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#ffffff"><meta name="generator" content="Valaxy 0.14.28"><meta name="description" content="Valaxy Theme Hardlight Preview."><meta property="og:description" content="Valaxy Theme Hardlight Preview."><meta property="og:locale" content="zh-CN"><meta property="og:site_name" content="Valaxy Theme Hardlight"><meta property="og:title" content="i18n"><meta property="og:image" content="/favicon.svg"><meta property="og:url" content="https://github.com/artiga033/valaxy-theme-hardlight/"></head><body><div id="app" data-server-rendered="true"><!--[--><!----><!--[--><!--]--><!----><!--[--><div id="bg-layer" class="bg"></div><div id="bg-img" class="bg" style="background-image:url(https://s.a33.su/e3-2018-halo-infinite-cover-1920x1080.jpg)"></div><div class="antialiased"><nav w="full" class="flex justify-between items-center font-bold light-stream md:sticky z-10 top-0 w-screen h-4rem" data-v-46d3aab9=""><a href="/valaxy-theme-hardlight/" class="text-xl pl-2" aria-label="Valaxy Theme Hardlight" data-v-46d3aab9=""><img class="inline-block mr-2" style="width:50px;height:35px" alt="logo" src="/favicon.svg" data-v-46d3aab9=""><span class="hidden md:inline" data-v-46d3aab9="">Valaxy Theme Hardlight</span></a><div class="flex pr-4" data-v-46d3aab9=""><button type="button" aria-label="Expand Menu" class="text-8 md:hidden <md:mr-8" data-v-46d3aab9=""><div i-fluent:navigation-24-regular="" data-v-46d3aab9=""></div></button><ul class="inline <md:hidden" data-v-46d3aab9=""><!--[--><li class="text-lg inline px-2" data-v-46d3aab9=""><a href="/valaxy-theme-hardlight/tags" class="" rel="noopener" data-v-46d3aab9=""><!--[-->Tags<!--]--></a></li><li class="text-lg inline px-2" data-v-46d3aab9=""><a href="/valaxy-theme-hardlight/links" class="" rel="noopener" data-v-46d3aab9=""><!--[-->Links<!--]--></a></li><li class="text-lg inline px-2" data-v-46d3aab9=""><a rel="noopener" href="https://github.com/artiga033/valaxy-theme-hardlight" target="_blank" data-v-46d3aab9=""><!--[-->GitHub<!--]--><!----></a></li><li class="text-lg inline px-2" data-v-46d3aab9=""><a href="/valaxy-theme-hardlight/atom.xml" class="" rel="noopener" data-v-46d3aab9=""><!--[-->RSS<!--]--></a></li><li class="text-lg inline px-2" data-v-46d3aab9=""><a rel="noopener" href="https://github.com/YunYouJun/valaxy" target="_blank" data-v-46d3aab9=""><!--[-->Valaxy →<!--]--><!----></a></li><!--]--></ul><button class="text-8" type="button" aria-label="Toggle Dark Mode" data-v-46d3aab9=""><div i-fluent:lightbulb-filament-24-regular="" data-v-46d3aab9=""></div></button></div></nav><header><!--[--><!--]--></header><!-- <PersonInfo class="fixed right-0" /> --><main class="max-w-3xl mx-auto px-4 sm:px-6 xl:max-w-5xl xl:px-0"><!--[--><article class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-10 space-y-1 text-center"><dl><dt class="sr-only">Published on</dt><dd class="text-base leading-6 font-medium text-gray-500"><time datetime="2022-04-09">2022-04-09</time></dd></dl><h1 class="st-text text-3xl leading-9 font-extrabold tracking-tight sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">i18n</h1></header><div class=""><div class="card"><main><div w="full" flex="~"><!--[--><div class="content" flex="~ col grow" w="full" p="l-4 lt-md:0"><!--[--><!--]--><!--[--><!--]--><!--[--><div class="markdown-body prose max-w-none pb-8"><article class="markdown-body"><!--[--><!--[--><div class="tip custom-block"><p class="custom-block-title"><span lang="en">TIP</span><span lang="zh-CN">提示</span></p><p>You can click this button to toggle locales.</p></div><div class="text-center"><!-- <YunToggleLocale class="shadow" /> --></div><div lang="zh-CN"><blockquote><p>在一个页面中实现 i18n</p></blockquote><p>为了使 <a target="_blank" rel="noreferrer" href="https://github.com/YunYouJun/valaxy"><!--[-->Valaxy<!--]--><!----></a> 成为一个国际化的项目，i18n 是必不可少的。</p><p>常见的 i18n 方案为采用不同的路径（如 <code>/zh-CN/</code>）或解析不同的域名（<code>cn.xxx.xxx</code>）来分别维护。</p><blockquote><p>此外还可使用 <a target="_blank" rel="noreferrer" href="https://crowdin.com/"><!--[-->crowdin<!--]--><!----></a> 平台辅助用户进行多语言翻译。</p></blockquote><p>但对于博客来说，这显然都很麻烦。 当你需要 i18n 时，你不得不同时维护多个目录下的文章。<br>当文章间存在相同的示例时，你还需要维护相同的内容。非常不优雅。</p><p>Valaxy 中， 站点的独立字段部分（如文章目录：Table of Contents）基于 <a target="_blank" rel="noreferrer" href="https://vue-i18n.intlify.dev/"><!--[-->vue-i18n<!--]--><!----></a> 实现， 而文章内容部分的大段文本则采用另一种 CSS i18n 的方案。</p><p><a aria-current="page" href="/valaxy-theme-hardlight/posts/i18n#result" class="router-link-active router-link-exact-active"><!--[-->我想先看看效果<!--]--></a></p></div><div lang="en"><blockquote><p><strong>i18n in One Page</strong></p></blockquote><p>In order to make <a target="_blank" rel="noreferrer" href="https://github.com/YunYouJun/valaxy"><!--[-->Valaxy<!--]--><!----></a> an international project, i18n is essential.</p><p>Common i18n schemes are maintained separately using different paths (e.g. <code>/zh-CN/</code>) or resolving different domain names (<code>cn.xxx.xxx</code>).</p><blockquote><p>In addition, the <a target="_blank" rel="noreferrer" href="https://crowdin.com/"><!--[-->crowdin<!--]--><!----></a> platform can be used to assist users with multilingual translations.</p></blockquote><p>But for blogs, this is obviously all a hassle. When you need i18n, you have to maintain articles in multiple directories at the same time.<br>You also have to maintain the same content when the same examples exist between articles. Very inelegant.</p><p>In Valaxy, the The standalone fields of the site (e.g. Table of Contents) are implemented based on <a target="_blank" rel="noreferrer" href="https://vue-i18n.intlify.dev/"><!--[-->vue-i18n<!--]--><!----></a>. The large text sections of the article content section use a different CSS i18n scheme.</p><p><a aria-current="page" href="/valaxy-theme-hardlight/posts/i18n#result" class="router-link-active router-link-exact-active"><!--[-->I want to see the result first.<!--]--></a></p></div><h2 id="vue-i18n" tabindex="-1">Vue-i18n <a aria-current="page" href="/valaxy-theme-hardlight/posts/i18n#vue-i18n" class="router-link-active router-link-exact-active header-anchor" aria-hidden="true"><!--[-->#<!--]--></a></h2><div lang="zh-CN"><p>配置 Vite Vue-i18n 插件 <a target="_blank" rel="noreferrer" href="https://github.com/intlify/bundle-tools/tree/main/packages/vite-plugin-vue-i18n"><!--[-->@intlify/vite-plugin-vue-i18n<!--]--><!----></a>：</p></div><div lang="en"><p>Config Vite Vue-i18n plugin <a target="_blank" rel="noreferrer" href="https://github.com/intlify/bundle-tools/tree/main/packages/vite-plugin-vue-i18n"><!--[-->@intlify/vite-plugin-vue-i18n<!--]--><!----></a>：</p></div><div class="language-ts"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89ddff;font-style:italic">import</span><span style="color:#a6accd"> path </span><span style="color:#89ddff;font-style:italic">from</span><span style="color:#a6accd"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">node:path</span><span style="color:#89ddff">'</span></span>
<span class="line"><span style="color:#89ddff;font-style:italic">import</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span><span style="color:#f07178"> </span><span style="color:#a6accd">defineConfig</span><span style="color:#f07178"> </span><span style="color:#89ddff">}</span><span style="color:#a6accd"> </span><span style="color:#89ddff;font-style:italic">from</span><span style="color:#a6accd"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">vite</span><span style="color:#89ddff">'</span></span>
<span class="line"><span style="color:#89ddff;font-style:italic">import</span><span style="color:#a6accd"> VueI18n </span><span style="color:#89ddff;font-style:italic">from</span><span style="color:#a6accd"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">@intlify/vite-plugin-vue-i18n</span><span style="color:#89ddff">'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89ddff;font-style:italic">export</span><span style="color:#a6accd"> </span><span style="color:#89ddff;font-style:italic">default</span><span style="color:#a6accd"> </span><span style="color:#82aaff">defineConfig</span><span style="color:#a6accd">(</span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#f07178">plugins</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> [</span></span>
<span class="line"><span style="color:#a6accd">    </span><span style="color:#82aaff">VueI18n</span><span style="color:#a6accd">(</span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#a6accd">      </span><span style="color:#f07178">runtimeOnly</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> </span><span style="color:#ff9cac">true</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#a6accd">      </span><span style="color:#f07178">compositionOnly</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> </span><span style="color:#ff9cac">true</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#a6accd">      </span><span style="color:#f07178">include</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> [path</span><span style="color:#89ddff">.</span><span style="color:#82aaff">resolve</span><span style="color:#a6accd">(__dirname</span><span style="color:#89ddff">,</span><span style="color:#a6accd"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">locales/**</span><span style="color:#89ddff">'</span><span style="color:#a6accd">)]</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#a6accd">    </span><span style="color:#89ddff">}</span><span style="color:#a6accd">)</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#a6accd">  ]</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#89ddff">}</span><span style="color:#a6accd">)</span></span>
<span class="line"></span></code></pre></div><div lang="zh-CN"><p>在 <code>locales</code> 目录下配置 <code>zh-CN.yml</code> 与 <code>en.yml</code>：</p></div><div lang="en"><p>Write <code>zh-CN.yml</code> and <code>en.yml</code> in <code>locales</code>.</p></div><div class="language-yaml"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676e95;font-style:italic"># zh-CN.yml</span></span>
<span class="line"><span style="color:#f07178">sidebar</span><span style="color:#89ddff">:</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#f07178">toc</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> </span><span style="color:#c3e88d">文章目录</span></span>
<span class="line"></span></code></pre></div><div class="language-yaml"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676e95;font-style:italic"># en.yml</span></span>
<span class="line"><span style="color:#f07178">sidebar</span><span style="color:#89ddff">:</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#f07178">toc</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> </span><span style="color:#c3e88d">Table of Contents</span></span>
<span class="line"></span></code></pre></div><div lang="zh-CN"><p>并在主入口文件（如 <code>main.ts</code>）中初始化：</p></div><div lang="en"><p>and initialized in the main entry file (e.g. <code>main.ts</code>).</p></div><div class="language-ts"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89ddff;font-style:italic">import</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span><span style="color:#f07178"> </span><span style="color:#a6accd">createI18n</span><span style="color:#f07178"> </span><span style="color:#89ddff">}</span><span style="color:#a6accd"> </span><span style="color:#89ddff;font-style:italic">from</span><span style="color:#a6accd"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">vue-i18n</span><span style="color:#89ddff">'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676e95;font-style:italic">// import { createApp } from 'vue'</span></span>
<span class="line"><span style="color:#676e95;font-style:italic">// import App from './App.vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676e95;font-style:italic">/*</span></span>
<span class="line"><span style="color:#676e95;font-style:italic"> * All i18n resources specified in the plugin `include` option can be loaded</span></span>
<span class="line"><span style="color:#676e95;font-style:italic"> * at once using the import syntax</span></span>
<span class="line"><span style="color:#676e95;font-style:italic"> */</span></span>
<span class="line"><span style="color:#89ddff;font-style:italic">import</span><span style="color:#a6accd"> messages </span><span style="color:#89ddff;font-style:italic">from</span><span style="color:#a6accd"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">@intlify/vite-plugin-vue-i18n/messages</span><span style="color:#89ddff">'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#c792ea">const</span><span style="color:#a6accd"> i18n </span><span style="color:#89ddff">=</span><span style="color:#a6accd"> </span><span style="color:#82aaff">createI18n</span><span style="color:#a6accd">(</span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#f07178">legacy</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> </span><span style="color:#ff9cac">false</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#f07178">locale</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">en</span><span style="color:#89ddff">'</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#a6accd">  messages</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#89ddff">}</span><span style="color:#a6accd">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676e95;font-style:italic">// const app = createApp(App)</span></span>
<span class="line"><span style="color:#a6accd">app</span><span style="color:#89ddff">.</span><span style="color:#82aaff">use</span><span style="color:#a6accd">(i18n)</span></span>
<span class="line"></span></code></pre></div><div lang="zh-CN"><p>此时即可在 Vue 中使用 <code>t('')</code> 来翻译对应字段文本。</p></div><div lang="en"><p>You can then use <code>t('')</code> in Vue to translate the text of the corresponding field.</p></div><div class="language-vue"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89ddff">&lt;</span><span style="color:#f07178">script</span><span style="color:#a6accd"> </span><span style="color:#c792ea">lang</span><span style="color:#89ddff">=</span><span style="color:#89ddff">"</span><span style="color:#c3e88d">ts</span><span style="color:#89ddff">"</span><span style="color:#a6accd"> </span><span style="color:#c792ea">setup</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"><span style="color:#89ddff;font-style:italic">import</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span><span style="color:#f07178"> </span><span style="color:#a6accd">useI18n</span><span style="color:#f07178"> </span><span style="color:#89ddff">}</span><span style="color:#a6accd"> </span><span style="color:#89ddff;font-style:italic">from</span><span style="color:#a6accd"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">vue-i18n</span><span style="color:#89ddff">'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#c792ea">const</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span><span style="color:#a6accd"> t </span><span style="color:#89ddff">}</span><span style="color:#a6accd"> </span><span style="color:#89ddff">=</span><span style="color:#a6accd"> </span><span style="color:#82aaff">useI18n</span><span style="color:#a6accd">()</span></span>
<span class="line"><span style="color:#89ddff">&lt;/</span><span style="color:#f07178">script</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89ddff">&lt;</span><span style="color:#f07178">template</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#89ddff">&lt;</span><span style="color:#f07178">h2</span><span style="color:#89ddff">&gt;</span><span style="color:#a6accd"> {{ t("sidebar.toc") }} </span><span style="color:#89ddff">&lt;/</span><span style="color:#f07178">h2</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"><span style="color:#89ddff">&lt;/</span><span style="color:#f07178">template</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="messages-when-ssg" tabindex="-1">Messages when SSG <a aria-current="page" href="/valaxy-theme-hardlight/posts/i18n#messages-when-ssg" class="router-link-active router-link-exact-active header-anchor" aria-hidden="true"><!--[-->#<!--]--></a></h3><div lang="zh-CN"><p><code>vue-i18n</code> 支持使用虚拟模块 <code>@intlify/vite-plugin-vue-i18n/messages</code> 的方式来导入多语言。</p><p>可惜的是，它并没有完美地支持 SSR。<a target="_blank" rel="noreferrer" href="https://github.com/intlify/bundle-tools/issues/78"><!--[-->#78 | intlify/bundle-tools<!--]--><!----></a></p><p>而 Vite 的 <code>i<wbr>mport.meta.globEager</code> 导入必须使用静态字符串。</p></div><div lang="en"><p><code>vue-i18n</code> supports importing multiple languages by using the virtual module <code>@intlify/vite-plugin-vue-i18n/messages</code>.</p><p>Unfortunately, it doesn't support SSR perfectly.<a target="_blank" rel="noreferrer" href="https://github.com/intlify/bundle-tools/issues/78"><!--[-->#78 | intlify/bundle-tools<!--]--><!----></a></p><p>And Vite's <code>i<wbr>mport.meta.globEager</code> import must use a static string.</p></div><div class="language-ts"><span class="copy"></span><div class="highlight-lines"><br><br><div class="highlighted">&nbsp;</div><br><br><br><br><br><br></div><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#c792ea">const</span><span style="color:#a6accd"> messages </span><span style="color:#89ddff">=</span><span style="color:#a6accd"> Object</span><span style="color:#89ddff">.</span><span style="color:#82aaff">fromEntries</span><span style="color:#a6accd">(</span></span>
<span class="line"><span style="color:#a6accd">  Object</span><span style="color:#89ddff">.</span><span style="color:#82aaff">entries</span><span style="color:#a6accd">(</span></span>
<span class="line"><span style="color:#a6accd">    </span><span style="color:#89ddff;font-style:italic">import</span><span style="color:#89ddff">.</span><span style="color:#a6accd">meta</span><span style="color:#89ddff">.</span><span style="color:#82aaff">globEager</span><span style="color:#a6accd">(</span><span style="color:#89ddff">'</span><span style="color:#c3e88d">../../locales/*.y(a)?ml</span><span style="color:#89ddff">'</span><span style="color:#a6accd">))</span></span>
<span class="line"><span style="color:#a6accd">    </span><span style="color:#89ddff">.</span><span style="color:#82aaff">map</span><span style="color:#a6accd">(</span><span style="color:#89ddff">([</span><span style="color:#a6accd;font-style:italic">key</span><span style="color:#89ddff">,</span><span style="color:#a6accd"> </span><span style="color:#a6accd;font-style:italic">value</span><span style="color:#89ddff">])</span><span style="color:#a6accd"> </span><span style="color:#c792ea">=&gt;</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#f07178">      </span><span style="color:#c792ea">const</span><span style="color:#f07178"> </span><span style="color:#a6accd">yaml</span><span style="color:#f07178"> </span><span style="color:#89ddff">=</span><span style="color:#f07178"> </span><span style="color:#a6accd">key</span><span style="color:#89ddff">.</span><span style="color:#82aaff">endsWith</span><span style="color:#f07178">(</span><span style="color:#89ddff">'</span><span style="color:#c3e88d">.yaml</span><span style="color:#89ddff">'</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#f07178">      </span><span style="color:#89ddff;font-style:italic">return</span><span style="color:#f07178"> [</span><span style="color:#a6accd">key</span><span style="color:#89ddff">.</span><span style="color:#82aaff">slice</span><span style="color:#f07178">(</span><span style="color:#f78c6c">14</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#a6accd">yaml</span><span style="color:#f07178"> </span><span style="color:#89ddff">?</span><span style="color:#f07178"> </span><span style="color:#89ddff">-</span><span style="color:#f78c6c">5</span><span style="color:#f07178"> </span><span style="color:#89ddff">:</span><span style="color:#f07178"> </span><span style="color:#89ddff">-</span><span style="color:#f78c6c">4</span><span style="color:#f07178">)</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#a6accd">value</span><span style="color:#89ddff">.</span><span style="color:#a6accd">default</span><span style="color:#f07178">]</span></span>
<span class="line"><span style="color:#f07178">    </span><span style="color:#89ddff">}</span><span style="color:#a6accd">)</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#a6accd">)</span></span>
<span class="line"></span></code></pre></div><div lang="zh-CN"><p>当拥有确定目录时，它是奏效的，但 Valaxy 还需要将 Valaxy 自身的 <code>locales</code> 与主题的 <code>locales</code> 以及用户自定义的 <code>locales</code> 进行合并。 这意味着我们不能使用变量来拼接字符串进行导入，对于不同包管理器的目录结构不同，我们很难确定这些 <code>locales</code> 处于何处的相对位置。</p><p>因此我采用插件虚拟模块（<code>@valaxyjs/locales</code>）的形式实现（依次导入各目录下的 locales 数据并合并）：</p><blockquote><p>Vite 虚拟模块的原理其实就是拼接字符串。</p></blockquote></div><div lang="en"><p>It works when there is a defined directory, but Valaxy also needs to merge Valaxy's own <code>locales</code> with the theme's <code>locales</code> and user-defined <code>locales</code>. This means that we cannot use variables to splice strings for import, and it is difficult to determine the relative location of where these <code>locales</code> are for different package managers with different directory structures.</p><p>So I implemented it in the form of a plugin virtual module (<code>@valaxyjs/locales</code>):</p><blockquote><p>The principle of the Vite virtual module is actually a spliced string.</p></blockquote></div><div class="language-ts"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89ddff;font-style:italic">import</span><span style="color:#a6accd"> </span><span style="color:#89ddff;font-style:italic">type</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span><span style="color:#f07178"> </span><span style="color:#a6accd">Plugin</span><span style="color:#f07178"> </span><span style="color:#89ddff">}</span><span style="color:#a6accd"> </span><span style="color:#89ddff;font-style:italic">from</span><span style="color:#a6accd"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">vite</span><span style="color:#89ddff">'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676e95;font-style:italic">// import the locales data in each directory in turn and merge them</span></span>
<span class="line"><span style="color:#c792ea">function</span><span style="color:#a6accd"> </span><span style="color:#82aaff">generateLocales</span><span style="color:#89ddff">(</span><span style="color:#a6accd;font-style:italic">roots</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> </span><span style="color:#ffcb6b">string</span><span style="color:#a6accd">[]</span><span style="color:#89ddff">)</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#c792ea">const</span><span style="color:#f07178"> </span><span style="color:#a6accd">imports</span><span style="color:#89ddff">:</span><span style="color:#f07178"> </span><span style="color:#ffcb6b">string</span><span style="color:#f07178">[] </span><span style="color:#89ddff">=</span><span style="color:#f07178"> [</span></span>
<span class="line"><span style="color:#f07178">    </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">const messages = { "zh-CN": {}, en: {} }</span><span style="color:#89ddff">'</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#f07178">  ]</span></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#c792ea">const</span><span style="color:#f07178"> </span><span style="color:#a6accd">languages</span><span style="color:#f07178"> </span><span style="color:#89ddff">=</span><span style="color:#f07178"> [</span><span style="color:#89ddff">'</span><span style="color:#c3e88d">zh-CN</span><span style="color:#89ddff">'</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">en</span><span style="color:#89ddff">'</span><span style="color:#f07178">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#a6accd">roots</span><span style="color:#89ddff">.</span><span style="color:#82aaff">forEach</span><span style="color:#f07178">(</span><span style="color:#89ddff">(</span><span style="color:#a6accd;font-style:italic">root</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#a6accd;font-style:italic">i</span><span style="color:#89ddff">)</span><span style="color:#f07178"> </span><span style="color:#c792ea">=&gt;</span><span style="color:#f07178"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#f07178">    </span><span style="color:#a6accd">languages</span><span style="color:#89ddff">.</span><span style="color:#82aaff">forEach</span><span style="color:#f07178">(</span><span style="color:#89ddff">(</span><span style="color:#a6accd;font-style:italic">lang</span><span style="color:#89ddff">)</span><span style="color:#f07178"> </span><span style="color:#c792ea">=&gt;</span><span style="color:#f07178"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#f07178">      </span><span style="color:#c792ea">const</span><span style="color:#f07178"> </span><span style="color:#a6accd">langYml</span><span style="color:#f07178"> </span><span style="color:#89ddff">=</span><span style="color:#f07178"> </span><span style="color:#89ddff">`${</span><span style="color:#a6accd">root</span><span style="color:#89ddff">}</span><span style="color:#c3e88d">/locales/</span><span style="color:#89ddff">${</span><span style="color:#a6accd">lang</span><span style="color:#89ddff">}</span><span style="color:#c3e88d">.yml</span><span style="color:#89ddff">`</span></span>
<span class="line"><span style="color:#f07178">      </span><span style="color:#89ddff;font-style:italic">if</span><span style="color:#f07178"> (</span><span style="color:#a6accd">fs</span><span style="color:#89ddff">.</span><span style="color:#82aaff">existsSync</span><span style="color:#f07178">(</span><span style="color:#a6accd">langYml</span><span style="color:#f07178">) </span><span style="color:#89ddff">&amp;&amp;</span><span style="color:#f07178"> </span><span style="color:#a6accd">fs</span><span style="color:#89ddff">.</span><span style="color:#82aaff">readFileSync</span><span style="color:#f07178">(</span><span style="color:#a6accd">langYml</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">utf-8</span><span style="color:#89ddff">'</span><span style="color:#f07178">)) </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#f07178">        </span><span style="color:#c792ea">const</span><span style="color:#f07178"> </span><span style="color:#a6accd">varName</span><span style="color:#f07178"> </span><span style="color:#89ddff">=</span><span style="color:#f07178"> </span><span style="color:#a6accd">lang</span><span style="color:#89ddff">.</span><span style="color:#82aaff">replace</span><span style="color:#f07178">(</span><span style="color:#89ddff">'</span><span style="color:#c3e88d">-</span><span style="color:#89ddff">'</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#89ddff">''</span><span style="color:#f07178">) </span><span style="color:#89ddff">+</span><span style="color:#f07178"> </span><span style="color:#a6accd">i</span></span>
<span class="line"><span style="color:#89ddff">        </span><span style="color:#676e95;font-style:italic">// in windows, you need to change slash</span></span>
<span class="line"><span style="color:#89ddff">        </span><span style="color:#676e95;font-style:italic">// more info you can refer 'packages/valaxy/src/node/plugins/index.ts'</span></span>
<span class="line"><span style="color:#f07178">        </span><span style="color:#a6accd">imports</span><span style="color:#89ddff">.</span><span style="color:#82aaff">push</span><span style="color:#f07178">(</span><span style="color:#89ddff">`</span><span style="color:#c3e88d">import </span><span style="color:#89ddff">${</span><span style="color:#a6accd">varName</span><span style="color:#89ddff">}</span><span style="color:#c3e88d"> from "</span><span style="color:#89ddff">${</span><span style="color:#a6accd">langYml</span><span style="color:#89ddff">}</span><span style="color:#c3e88d">"</span><span style="color:#89ddff">`</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#f07178">        </span><span style="color:#a6accd">imports</span><span style="color:#89ddff">.</span><span style="color:#82aaff">push</span><span style="color:#f07178">(</span><span style="color:#89ddff">`</span><span style="color:#c3e88d">Object.assign(messages['</span><span style="color:#89ddff">${</span><span style="color:#a6accd">lang</span><span style="color:#89ddff">}</span><span style="color:#c3e88d">'], </span><span style="color:#89ddff">${</span><span style="color:#a6accd">varName</span><span style="color:#89ddff">}</span><span style="color:#c3e88d">)</span><span style="color:#89ddff">`</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#f07178">      </span><span style="color:#89ddff">}</span></span>
<span class="line"><span style="color:#f07178">    </span><span style="color:#89ddff">}</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#89ddff">}</span><span style="color:#f07178">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#a6accd">imports</span><span style="color:#89ddff">.</span><span style="color:#82aaff">push</span><span style="color:#f07178">(</span><span style="color:#89ddff">'</span><span style="color:#c3e88d">export default messages</span><span style="color:#89ddff">'</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#89ddff;font-style:italic">return</span><span style="color:#f07178"> </span><span style="color:#a6accd">imports</span><span style="color:#89ddff">.</span><span style="color:#82aaff">join</span><span style="color:#f07178">(</span><span style="color:#89ddff">'</span><span style="color:#a6accd">\n</span><span style="color:#89ddff">'</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#89ddff">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89ddff;font-style:italic">export</span><span style="color:#a6accd"> </span><span style="color:#c792ea">function</span><span style="color:#a6accd"> </span><span style="color:#82aaff">createValaxyPlugin</span><span style="color:#89ddff">(</span><span style="color:#a6accd;font-style:italic">options</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> </span><span style="color:#ffcb6b">ResolvedValaxyOptions</span><span style="color:#89ddff">):</span><span style="color:#a6accd"> </span><span style="color:#ffcb6b">Plugin</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#89ddff">  </span><span style="color:#676e95;font-style:italic">// ...</span></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#c792ea">const</span><span style="color:#f07178"> </span><span style="color:#a6accd">roots</span><span style="color:#f07178"> </span><span style="color:#89ddff">=</span><span style="color:#f07178"> [</span><span style="color:#a6accd">options</span><span style="color:#89ddff">.</span><span style="color:#a6accd">clientRoot</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#a6accd">options</span><span style="color:#89ddff">.</span><span style="color:#a6accd">themeRoot</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#a6accd">options</span><span style="color:#89ddff">.</span><span style="color:#a6accd">userRoot</span><span style="color:#f07178">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#89ddff;font-style:italic">return</span><span style="color:#f07178"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#f07178">    name</span><span style="color:#89ddff">:</span><span style="color:#f07178"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">Valaxy</span><span style="color:#89ddff">'</span><span style="color:#89ddff">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f07178">    load</span><span style="color:#89ddff">(</span><span style="color:#a6accd;font-style:italic">id</span><span style="color:#89ddff">)</span><span style="color:#f07178"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#89ddff">      </span><span style="color:#676e95;font-style:italic">// ...</span></span>
<span class="line"><span style="color:#f07178">      </span><span style="color:#89ddff;font-style:italic">if</span><span style="color:#f07178"> (</span><span style="color:#a6accd">id</span><span style="color:#f07178"> </span><span style="color:#89ddff">===</span><span style="color:#f07178"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">/@valaxyjs/locales</span><span style="color:#89ddff">'</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#f07178">        </span><span style="color:#89ddff;font-style:italic">return</span><span style="color:#f07178"> </span><span style="color:#82aaff">generateLocales</span><span style="color:#f07178">(</span><span style="color:#a6accd">roots</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#f07178">    </span><span style="color:#89ddff">},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f07178">    </span><span style="color:#c792ea">async</span><span style="color:#f07178"> handleHotUpdate</span><span style="color:#89ddff">(</span><span style="color:#a6accd;font-style:italic">ctx</span><span style="color:#89ddff">)</span><span style="color:#f07178"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#89ddff">      </span><span style="color:#676e95;font-style:italic">// ...</span></span>
<span class="line"><span style="color:#f07178">    </span><span style="color:#89ddff">},</span></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#89ddff">}</span></span>
<span class="line"><span style="color:#89ddff">}</span></span>
<span class="line"></span></code></pre></div><div lang="zh-CN"><p>最后在 i18n 的初始化文件加载：</p></div><div lang="en"><p>Finally load in the i18n initialization file:</p></div><div class="language-ts"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676e95;font-style:italic">// i18n.ts</span></span>
<span class="line"><span style="color:#89ddff;font-style:italic">import</span><span style="color:#a6accd"> messages </span><span style="color:#89ddff;font-style:italic">from</span><span style="color:#a6accd"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">/@valaxyjs/locales</span><span style="color:#89ddff">'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#c792ea">const</span><span style="color:#a6accd"> i18n </span><span style="color:#89ddff">=</span><span style="color:#a6accd"> </span><span style="color:#82aaff">createI18n</span><span style="color:#a6accd">(</span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#f07178">legacy</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> </span><span style="color:#ff9cac">false</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#f07178">locale</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">en</span><span style="color:#89ddff">'</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#a6accd">  messages</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#89ddff">}</span><span style="color:#a6accd">)</span></span>
<span class="line"><span style="color:#a6accd">app</span><span style="color:#89ddff">.</span><span style="color:#82aaff">use</span><span style="color:#a6accd">(i18n)</span></span>
<span class="line"></span></code></pre></div><h2 id="css-i18n-another-solution" tabindex="-1">CSS i18n - Another solution <a aria-current="page" href="/valaxy-theme-hardlight/posts/i18n#css-i18n-another-solution" class="router-link-active router-link-exact-active header-anchor" aria-hidden="true"><!--[-->#<!--]--></a></h2><div lang="zh-CN"><blockquote><p>CSS i18n - 另一种互补解决方案</p></blockquote></div><div lang="en"><blockquote><p>CSS i18n - Another complementary solution</p></blockquote></div><div lang="zh-CN"><p>文章部分拥有大段的文本，而 <code>vue-i18n</code> 的场景则在于一些独立的字段翻译。</p><p>而传统的分文件独立管理的方式，对于博客来说其实并不方便。<br>大多数情况，你并不会想专门建立一个文件夹来管理它。</p><p>因此我尝试使用纯 CSS 解决该问题。</p></div><div lang="en"><p>While the article section has large sections of text, the scenario of <code>vue-i18n</code> lies in some separate field translations.</p><p>And the traditional way of managing them independently in separate files is not really convenient for blogs.<br>In most cases, you don't want to create a dedicated folder to manage it.</p><p>So I tried to solve the problem using pure CSS.</p></div><div lang="zh-CN"><div class="tip custom-block"><p class="custom-block-title"><span lang="en">思路</span><span lang="zh-CN">思路</span></p><p>即借助 CSS 规则，根据对应语言，显示对应区块内容。<br>大体方案：通过 <a target="_blank" rel="noreferrer" href="https://github.com/markdown-it/markdown-it-container"><!--[-->markdown-it-container<!--]--><!----></a> 设置 fence 预编译 Markdown， 为需要进行 i18n 的段落包裹新的 <code>&lt;div lang="zh-CN"&gt;&lt;/div&gt;</code>，并使用 CSS 默认隐藏它们。 当页面初始化或切换语言时，为 html 添加对应语言类，编写对应 CSS 以在该类下显示对应语言的区块。</p></div></div><div lang="en"><div class="tip custom-block"><p class="custom-block-title"><span lang="en">IDEA</span><span lang="zh-CN">IDEA</span></p><p>That is, with the help of CSS rules, the content of the corresponding block is displayed according to the corresponding language.<br>The general solution: set fence to pre-compile Markdown via <a target="_blank" rel="noreferrer" href="https://github.com/markdown-it/markdown-it-container"><!--[-->markdown-it-container<!--]--><!----></a>. Wrap new <code>&lt;div lang="zh-CN"&gt;&lt;/div&gt;</code>s for the paragraphs that need to be i18n and hide them by default with CSS. When the page initializes or switches languages, add the corresponding language class to html and write the corresponding CSS to display the corresponding language block under that class.</p></div></div><div lang="zh-CN"><p><strong>优势</strong>：</p><ul><li>可在同一个 Markdown 文件中进行维护，书写便捷</li><li>预加载与实时切换</li><li>URL 不变，便于管理与分享，且切换无需刷新页面</li></ul><p><strong>劣势</strong>：</p><ul><li>多语言内容被渲染在同一页面中，增加冗余（但我觉得这微小的体积完全是可以接受的）</li></ul></div><div lang="en"><p><strong>Advantages</strong>:</p><ul><li>Can be maintained in the same Markdown file, easy to write</li><li>Pre-loading and real-time switching</li><li>URLs remain unchanged, easy to manage and share, and switch without refreshing the page</li></ul><p><strong>Disadvantages</strong>:</p><ul><li>Multi-language content is rendered in the same page, adding redundancy (but I think the tiny size is perfectly acceptable)</li></ul></div><h3 id="result" tabindex="-1">Result <a aria-current="page" href="/valaxy-theme-hardlight/posts/i18n#result" class="router-link-active router-link-exact-active header-anchor" aria-hidden="true"><!--[-->#<!--]--></a></h3><div lang="zh-CN"><p><strong>效果如下</strong>（点击按钮切换）：</p></div><div lang="en"><p><strong>The effect is as follows</strong> (click the button to switch).</p></div><!-- <YunToggleLocale class="shadow" /> --><div lang="zh-CN"><p>另一种 i18n 方案。</p><blockquote><p>更多内容：...</p></blockquote></div><div lang="en"><p>Another i18n method.</p><blockquote><p>More info...</p></blockquote></div><div lang="zh-CN"><p>中文</p></div><div lang="en"><p>English</p></div><hr><div lang="zh-CN"><p><strong>书写方式</strong>如下：</p></div><div lang="en"><p><strong>Written like this</strong>:</p></div><div class="language-md"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#a6accd">::: zh-CN</span></span>
<span class="line"><span style="color:#a6accd">另一种 i18n 方案。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a6accd">更多内容：...</span></span>
<span class="line"><span style="color:#a6accd">:::</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a6accd">::: en</span></span>
<span class="line"><span style="color:#a6accd">Another i18n method.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a6accd">More info...</span></span>
<span class="line"><span style="color:#a6accd">:::</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a6accd">::: zh-CN</span></span>
<span class="line"><span style="color:#a6accd">中文</span></span>
<span class="line"><span style="color:#a6accd">:::</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a6accd">::: en</span></span>
<span class="line"><span style="color:#a6accd">English</span></span>
<span class="line"><span style="color:#a6accd">:::</span></span>
<span class="line"></span></code></pre></div><h3 id="steps" tabindex="-1">Steps <a aria-current="page" href="/valaxy-theme-hardlight/posts/i18n#steps" class="router-link-active router-link-exact-active header-anchor" aria-hidden="true"><!--[-->#<!--]--></a></h3><div lang="zh-CN"><p><strong>实现步骤</strong></p></div><div lang="zh-CN"><p>为了能够借助 CSS 处理 i18n，我们借助 markdown-it-container 的 fence 包裹 Markdown 中需要参与 i18n 的内容。</p></div><div lang="en"><p>To be able to handle i18n with CSS, we use markdown-it-container's fence to wrap Markdown content that needs to participate in i18n.</p></div><div class="language-ts"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89ddff;font-style:italic">export</span><span style="color:#a6accd"> </span><span style="color:#c792ea">function</span><span style="color:#a6accd"> </span><span style="color:#82aaff">containerPlugin</span><span style="color:#89ddff">(</span><span style="color:#a6accd;font-style:italic">md</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> </span><span style="color:#ffcb6b">MarkdownIt</span><span style="color:#89ddff">)</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#89ddff">  </span><span style="color:#676e95;font-style:italic">// ...</span></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#c792ea">const</span><span style="color:#f07178"> </span><span style="color:#a6accd">languages</span><span style="color:#f07178"> </span><span style="color:#89ddff">=</span><span style="color:#f07178"> [</span><span style="color:#89ddff">'</span><span style="color:#c3e88d">zh-CN</span><span style="color:#89ddff">'</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">en</span><span style="color:#89ddff">'</span><span style="color:#f07178">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#a6accd">languages</span><span style="color:#89ddff">.</span><span style="color:#82aaff">forEach</span><span style="color:#f07178">(</span><span style="color:#89ddff">(</span><span style="color:#a6accd;font-style:italic">lang</span><span style="color:#89ddff">)</span><span style="color:#f07178"> </span><span style="color:#c792ea">=&gt;</span><span style="color:#f07178"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#f07178">    </span><span style="color:#a6accd">md</span><span style="color:#89ddff">.</span><span style="color:#82aaff">use</span><span style="color:#f07178">(</span><span style="color:#a6accd">container</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#a6accd">lang</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#f07178">      </span><span style="color:#82aaff">render</span><span style="color:#89ddff">:</span><span style="color:#f07178"> </span><span style="color:#89ddff">(</span><span style="color:#a6accd;font-style:italic">tokens</span><span style="color:#89ddff">:</span><span style="color:#f07178"> </span><span style="color:#ffcb6b">Token</span><span style="color:#f07178">[]</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#a6accd;font-style:italic">idx</span><span style="color:#89ddff">:</span><span style="color:#f07178"> </span><span style="color:#ffcb6b">number</span><span style="color:#89ddff">)</span><span style="color:#f07178"> </span><span style="color:#c792ea">=&gt;</span></span>
<span class="line"><span style="color:#f07178">        </span><span style="color:#a6accd">tokens</span><span style="color:#f07178">[</span><span style="color:#a6accd">idx</span><span style="color:#f07178">]</span><span style="color:#89ddff">.</span><span style="color:#a6accd">nesting</span><span style="color:#f07178"> </span><span style="color:#89ddff">===</span><span style="color:#f07178"> </span><span style="color:#f78c6c">1</span><span style="color:#f07178"> </span><span style="color:#89ddff">?</span><span style="color:#f07178"> </span><span style="color:#89ddff">`</span><span style="color:#c3e88d">&lt;div lang="</span><span style="color:#89ddff">${</span><span style="color:#a6accd">lang</span><span style="color:#89ddff">}</span><span style="color:#c3e88d">"&gt;</span><span style="color:#a6accd">\n</span><span style="color:#89ddff">`</span><span style="color:#f07178"> </span><span style="color:#89ddff">:</span><span style="color:#f07178"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">&lt;/div&gt;</span><span style="color:#a6accd">\n</span><span style="color:#89ddff">'</span><span style="color:#89ddff">,</span></span>
<span class="line"><span style="color:#f07178">    </span><span style="color:#89ddff">}</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#89ddff">}</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#89ddff">}</span></span>
<span class="line"></span></code></pre></div><div lang="zh-CN"><p>这可以使：</p></div><div lang="en"><p>This allows:</p></div><div class="language-md"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#a6accd">::: zh-CN</span></span>
<span class="line"><span style="color:#a6accd">中文</span></span>
<span class="line"><span style="color:#a6accd">:::</span></span>
<span class="line"></span></code></pre></div><div lang="zh-CN"><p>变成 <code>&lt;div lang="zh-CN"&gt;&lt;/div&gt;</code> 的形式。</p><blockquote><p><a target="_blank" rel="noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/lang"><!--[-->lang<!--]--><!----></a> 是 HTML 的一个标准字段。</p></blockquote><p>为避免 class 命名冲突，我们可以采用 CSS attribute 的查询方式。</p><p>首先将 i18n 全部隐藏：</p></div><div lang="en"><p>Be <code>&lt;div lang="zh-CN"&gt;&lt;/div&gt;</code>.</p><blockquote><p><a target="_blank" rel="noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/lang"><!--[-->lang<!--]--><!----></a> is a standard field in HTML.</p></blockquote><p>To avoid class naming conflicts, we can use the CSS attribute query.</p><p>First, hide all i18n:</p></div><div class="language-scss"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#ffcb6b">html</span><span style="color:#89ddff">[</span><span style="color:#c792ea">lang</span><span style="color:#89ddff">]</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#89ddff">.</span><span style="color:#ffcb6b">markdown-body</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#a6accd">    </span><span style="color:#ffcb6b">div</span><span style="color:#89ddff">[</span><span style="color:#c792ea">lang</span><span style="color:#89ddff">]</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#a6accd">      </span><span style="color:#b2ccd6">display</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> none</span><span style="color:#89ddff">;</span></span>
<span class="line"><span style="color:#a6accd">    </span><span style="color:#89ddff">}</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#89ddff">}</span></span>
<span class="line"><span style="color:#89ddff">}</span></span>
<span class="line"></span></code></pre></div><div lang="zh-CN"><p>编写 CSS/SCSS 规则，设定 html <code>lang</code> 为对应语言时，显示对应语言的元素即可。</p></div><div lang="en"><p>Write CSS/SCSS rules and set html <code>lang</code> to display elements in the corresponding language when it is the corresponding language.</p></div><div class="language-scss"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#a6accd">$languages</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> zh-CN</span><span style="color:#89ddff">,</span><span style="color:#a6accd"> en</span><span style="color:#89ddff">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89ddff;font-style:italic">@each</span><span style="color:#a6accd"> $lang </span><span style="color:#89ddff;font-style:italic">in</span><span style="color:#a6accd"> $languages </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#ffcb6b">html</span><span style="color:#89ddff">[</span><span style="color:#c792ea">lang</span><span style="color:#89ddff">=</span><span style="color:#89ddff">"</span><span style="color:#89ddff">#{</span><span style="color:#a6accd">$lang</span><span style="color:#89ddff">}</span><span style="color:#89ddff">"</span><span style="color:#89ddff">]</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#a6accd">    </span><span style="color:#676e95;font-style:italic">// only for markdown</span></span>
<span class="line"><span style="color:#a6accd">    </span><span style="color:#89ddff">.</span><span style="color:#ffcb6b">markdown-body</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#a6accd">      </span><span style="color:#ffcb6b">div</span><span style="color:#89ddff">[</span><span style="color:#c792ea">lang</span><span style="color:#89ddff">=</span><span style="color:#89ddff">"</span><span style="color:#89ddff">#{</span><span style="color:#a6accd">$lang</span><span style="color:#89ddff">}</span><span style="color:#89ddff">"</span><span style="color:#89ddff">]</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#a6accd">        </span><span style="color:#b2ccd6">display</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> block</span><span style="color:#89ddff">;</span></span>
<span class="line"><span style="color:#a6accd">      </span><span style="color:#89ddff">}</span></span>
<span class="line"><span style="color:#a6accd">    </span><span style="color:#89ddff">}</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#89ddff">}</span></span>
<span class="line"><span style="color:#89ddff">}</span></span>
<span class="line"></span></code></pre></div><div lang="zh-CN"><p>为了帮助用户记住自己的语言，还请不要忘记初始化。</p></div><div lang="en"><p>To help users remember their language, please also don't forget to initialize.</p></div><div class="language-html"><span class="copy"></span><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted">&nbsp;</div><br><br><br><br><br><br></div><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89ddff">&lt;!</span><span style="color:#f07178">DOCTYPE</span><span style="color:#89ddff"> </span><span style="color:#c792ea">html</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"><span style="color:#89ddff">&lt;</span><span style="color:#f07178">html</span><span style="color:#89ddff"> </span><span style="color:#c792ea">lang</span><span style="color:#89ddff">=</span><span style="color:#89ddff">"</span><span style="color:#c3e88d">en</span><span style="color:#89ddff">"</span><span style="color:#89ddff"> </span><span style="color:#c792ea">class</span><span style="color:#89ddff">=</span><span style="color:#89ddff">"</span><span style="color:#c3e88d">i18n</span><span style="color:#89ddff">"</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89ddff">&lt;</span><span style="color:#f07178">head</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#676e95;font-style:italic">&lt;!-- ... --&gt;</span></span>
<span class="line"><span style="color:#89ddff">  &lt;</span><span style="color:#f07178">script</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"><span style="color:#a6accd">    (</span><span style="color:#c792ea">function</span><span style="color:#89ddff">()</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#f07178">      </span><span style="color:#c792ea">const</span><span style="color:#f07178"> </span><span style="color:#a6accd">locale</span><span style="color:#f07178"> </span><span style="color:#89ddff">=</span><span style="color:#f07178"> </span><span style="color:#a6accd">localStorage</span><span style="color:#89ddff">.</span><span style="color:#82aaff">getItem</span><span style="color:#f07178">(</span><span style="color:#89ddff">'</span><span style="color:#c3e88d">valaxy-locale</span><span style="color:#89ddff">'</span><span style="color:#f07178">) </span><span style="color:#89ddff">||</span><span style="color:#f07178"> </span><span style="color:#89ddff">'</span><span style="color:#c3e88d">en</span><span style="color:#89ddff">'</span></span>
<span class="line"><span style="color:#f07178">      </span><span style="color:#a6accd">document</span><span style="color:#89ddff">.</span><span style="color:#a6accd">documentElement</span><span style="color:#89ddff">.</span><span style="color:#82aaff">setAttribute</span><span style="color:#f07178">(</span><span style="color:#89ddff">'</span><span style="color:#c3e88d">lang</span><span style="color:#89ddff">'</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#a6accd">locale</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#f07178">    </span><span style="color:#89ddff">}</span><span style="color:#a6accd">)()</span></span>
<span class="line"><span style="color:#a6accd">  </span><span style="color:#89ddff">&lt;/</span><span style="color:#f07178">script</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"><span style="color:#89ddff">&lt;/</span><span style="color:#f07178">head</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"><span style="color:#89ddff">&lt;</span><span style="color:#f07178">body</span><span style="color:#89ddff">&gt;</span><span style="color:#a6accd">...</span><span style="color:#89ddff">&lt;/</span><span style="color:#f07178">body</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"><span style="color:#89ddff">&lt;/</span><span style="color:#f07178">html</span><span style="color:#89ddff">&gt;</span></span>
<span class="line"></span></code></pre></div><div lang="zh-CN"><p>切换语言时则可做如下处理：</p></div><div lang="en"><p>When switching languages, the following can be done.</p></div><div class="language-ts"><span class="copy"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#c792ea">function</span><span style="color:#a6accd"> </span><span style="color:#82aaff">toggleLocales</span><span style="color:#89ddff">(</span><span style="color:#a6accd;font-style:italic">lang</span><span style="color:#89ddff">:</span><span style="color:#a6accd"> </span><span style="color:#ffcb6b">val</span><span style="color:#89ddff">)</span><span style="color:#a6accd"> </span><span style="color:#89ddff">{</span></span>
<span class="line"><span style="color:#89ddff">  </span><span style="color:#676e95;font-style:italic">// ...</span></span>
<span class="line"><span style="color:#89ddff">  </span><span style="color:#676e95;font-style:italic">// save locale</span></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#a6accd">localStorage</span><span style="color:#89ddff">.</span><span style="color:#82aaff">setItem</span><span style="color:#f07178">(</span><span style="color:#89ddff">'</span><span style="color:#c3e88d">valaxy-locale</span><span style="color:#89ddff">'</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#a6accd">lang</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#89ddff">  </span><span style="color:#676e95;font-style:italic">// set html lang</span></span>
<span class="line"><span style="color:#f07178">  </span><span style="color:#a6accd">document</span><span style="color:#89ddff">.</span><span style="color:#a6accd">documentElement</span><span style="color:#89ddff">.</span><span style="color:#82aaff">setAttribute</span><span style="color:#f07178">(</span><span style="color:#89ddff">'</span><span style="color:#c3e88d">lang</span><span style="color:#89ddff">'</span><span style="color:#89ddff">,</span><span style="color:#f07178"> </span><span style="color:#a6accd">lang</span><span style="color:#f07178">)</span></span>
<span class="line"><span style="color:#89ddff">}</span></span>
<span class="line"></span></code></pre></div><div lang="zh-CN"><p>值得一提的是，在查看 <code>lang</code> 文档时，我意外地发现 <code>:lang</code> 也是一种支持的选择器。 因此上述的 CSS 中 <code>[lang="xxx"]</code> 也可以替换为 <code>:lang(xxx)</code>。</p><p>但是 <code>:lang()</code> 也会命中默认语言的 <code>div</code>（没有 lang 字段，但处于含有 lang 的标签中），因此为了安全，我们还是应该使用 class 的属性查询。</p></div><div lang="en"><p>It's worth mentioning that when looking at the <code>lang</code> documentation, I accidentally found that <code>:lang</code> is also a supported selector. So <code>[lang="xxx"]</code> in the CSS above could also be replaced with <code>:lang(xxx)</code>.</p><p>However, <code>:lang()</code> will also hit the default language <code>div</code> (which has no lang field but is in a tag containing lang), so to be safe we should still use the class attribute query.</p></div><div lang="zh-CN"><p>我认为 vue-i18n 与 CSS i18n 的互补，可以非常好地解决单页内的 i18n 切换。 不妨一试？</p></div><div lang="en"><p>I think vue-i18n complements CSS i18n and could be a very good solution for i18n switching within a single page. Why not give it a try?</p></div><!--]--><!--[--><!--]--><!--]--><div text="center"><!----></div><!--[--><div m="y-4" class="end flex justify-center items-center"><hr class="line inline-flex" w="full" m="!y-2"><span p="x-4" font="serif bold" class="whitespace-nowrap">Q.E.D.</span><hr class="line inline-flex" w="full" m="!y-2"></div><!--]--></article></div><!--[--><!--]--><!--]--></div><!--[--><!--]--><!--[--><!--]--><!--[--><!--]--><!----><!--[--><!--]--><!--]--></div><!--[--><!--]--></main></div><footer class="m-y-2 text-sm font-medium leading-5 flex justify-between"><div><h2 class="text-xs tracking-wide uppercase text-[var(--va-c-primary-light)]">&lt;Previous Article</h2><div class="link"><a href="/valaxy-theme-hardlight/posts/test" class="">Valaxy Test 文章内容测试</a></div></div><div><h2 class="text-xs tracking-wide uppercase text-[var(--va-c-primary-light)]">Next Article&gt;</h2><div class="link"><a href="/valaxy-theme-hardlight/posts/hardlight" class="">hardlight-test</a></div></div></footer></div></article><!--]--></main><div class="fixed right-8 bottom-8 hidden flex-col gap-3 flex"><!----></div><footer text="center sm" style="color:var(--va-c-text-light)" class="max-w-3xl mx-auto px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="card"><!----><p class="copyright flex justify-center items-center p1"><span>©<!----> 2023</span> | <span>artiga033</span></p><div class="powered p1"><span>由 <a href="https://github.com/YunYouJun/valaxy" target="_blank" rel="noopener">Valaxy</a> v0.14.28 驱动</span> | <span>主题 - <a href="https://github.com/artiga033/valaxy-theme-hardlight" title="valaxy-theme-hardlight" target="_blank">Hardlight</a> v0.0.1</span></div><!--[--><!--]--></div></footer></div><!--]--><!--]--></div><script>window.__INITIAL_STATE__='{"pinia":{}}'</script><script type="application/ld+json" id="schema-org-graph" data-h-3437552="">{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@id": "https://github.com/artiga033/valaxy-theme-hardlight/#identity",
      "@type": "Person",
      "name": "artiga033",
      "url": "https://github.com/artiga033/valaxy-theme-hardlight/",
      "image": {
        "@id": "https://github.com/artiga033/valaxy-theme-hardlight/#/schema/image/e1fe764"
      },
      "sameAs": [
        "/atom.xml",
        "https://github.com/artiga033",
        "https://music.163.com/#/user/home?id=341935835",
        "https://space.bilibili.com/7475074",
        "artiga033@hotmail.com"
      ]
    },
    {
      "@id": "https://github.com/artiga033/valaxy-theme-hardlight/#website",
      "@type": "WebSite",
      "dateModified": "2023-07-23T05:15:24+00:00",
      "datePublished": "2022-04-09T00:00:00+00:00",
      "inLanguage": "zh-CN",
      "name": "i18n",
      "url": "https://github.com/artiga033/valaxy-theme-hardlight/",
      "publisher": {
        "@id": "https://github.com/artiga033/valaxy-theme-hardlight/#identity"
      }
    },
    {
      "@id": "https://github.com/artiga033/valaxy-theme-hardlight/posts/i18n/#webpage",
      "@type": "WebPage",
      "description": "Valaxy Theme Hardlight Preview.",
      "name": "i18n",
      "url": "https://github.com/artiga033/valaxy-theme-hardlight/posts/i18n",
      "about": {
        "@id": "https://github.com/artiga033/valaxy-theme-hardlight/#identity"
      },
      "isPartOf": {
        "@id": "https://github.com/artiga033/valaxy-theme-hardlight/#website"
      },
      "potentialAction": [
        {
          "@type": "ReadAction",
          "target": [
            "https://github.com/artiga033/valaxy-theme-hardlight/posts/i18n"
          ]
        }
      ]
    },
    {
      "@id": "https://github.com/artiga033/valaxy-theme-hardlight/#/schema/image/e1fe764",
      "@type": "ImageObject",
      "contentUrl": "https://s.a33.su/avatar.png",
      "inLanguage": "zh-CN",
      "url": "https://s.a33.su/avatar.png"
    }
  ]
}</script></body></html>